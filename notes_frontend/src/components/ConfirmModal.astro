---
/**
 * Confirm modal usage:
 *  - Toggle visibility by adding/removing `hidden` on #confirm-modal
 *  - Dispatch custom events `confirm:yes` and `confirm:no` on document
 */
const { title = "Confirm", message = "Are you sure?" } = Astro.props;
---
<div id="confirm-modal" class="fixed inset-0 hidden items-center justify-center bg-black/30 z-50">
  <div class="o-card w-full max-w-md p-5">
    <h3 class="text-lg font-semibold mb-2">{title}</h3>
    <p class="text-gray-600 mb-4">{message}</p>
    <div class="flex justify-end gap-2">
      <button id="confirm-no" class="o-btn-ghost">Cancel</button>
      <button id="confirm-yes" class="o-btn bg-red-500 text-white hover:bg-red-600">Delete</button>
    </div>
  </div>
</div>

<script>
  function init() {
    const modal = document.getElementById("confirm-modal");
    const yes = document.getElementById("confirm-yes");
    const no = document.getElementById("confirm-no");
    if (!modal || !yes || !no) return;

    yes.addEventListener("click", () => {
      modal.classList.add("hidden");
      document.dispatchEvent(new CustomEvent("confirm:yes"));
    });
    no.addEventListener("click", () => {
      modal.classList.add("hidden");
      document.dispatchEvent(new CustomEvent("confirm:no"));
    });
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", init);
  } else {
    init();
  }
</script>
